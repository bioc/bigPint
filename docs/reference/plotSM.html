<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot static scatterplot matrices — plotSM • bigPint</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>


<meta property="og:title" content="Plot static scatterplot matrices — plotSM" />

<meta property="og:description" content="Plot static scatterplot matrix. Optionally, superimpose
differentially expressed genes (DEGs) onto scatterplot matrix." />

<meta property="og:image" content="http://lrutter.github.io/bigPint/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bigPint</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    Get Started
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/plotIntro.html">Introduction to bigPint plots</a>
    </li>
    <li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/data.html">Data object</a>
    </li>
    <li>
      <a href="../articles/dataMetrics.html">Data metrics object</a>
    </li>
    <li>
      <a href="../articles/createDataMetrics.html">Creating data metrics object</a>
    </li>
    <li>
      <a href="../articles/superimposeData.html">Alternatives to data metrics object</a>
    </li>
    <li>
      <a href="../articles/static.html">Producing static plots</a>
    </li>
    <li>
      <a href="../articles/interactive.html">Producing interactive plots</a>
    </li>
    <li>
      <a href="../articles/clusters.html">Hierarchical clustering</a>
    </li>
    <li>
      <a href="../articles/pipeline.html">Recommended RNA-seq pipeline</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li>
  <a href="https://github.com/lrutter/bigPint/">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot static scatterplot matrices</h1>
    <small class="dont-index">Source: <a href='https://github.com/lrutter/bigPint/blob/master/R/plotSM.R'><code>R/plotSM.R</code></a></small>
    <div class="hidden name"><code>plotSM.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Plot static scatterplot matrix. Optionally, superimpose
differentially expressed genes (DEGs) onto scatterplot matrix.</p>
    
    </div>

    <pre class="usage"><span class='fu'>plotSM</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>data</span>, <span class='kw'>dataMetrics</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>option</span> <span class='kw'>=</span> <span class='st'>"allPoints"</span>,
  <span class='kw'>saveFile</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>outDir</span> <span class='kw'>=</span> <span class='fu'>getwd</span>(), <span class='kw'>pointSize</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
  <span class='kw'>pointColor</span> <span class='kw'>=</span> <span class='st'>"orange"</span>, <span class='kw'>xbins</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>threshFC</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>threshOrth</span> <span class='kw'>=</span> <span class='fl'>3</span>,
  <span class='kw'>threshVar</span> <span class='kw'>=</span> <span class='st'>"FDR"</span>, <span class='kw'>threshVal</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>geneList</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>DATA FRAME | Read counts</p></td>
    </tr>
    <tr>
      <th>dataMetrics</th>
      <td><p>LIST | Differential expression metrics; default NULL</p></td>
    </tr>
    <tr>
      <th>option</th>
      <td><p>CHARACTER STRING ["foldChange" | "orthogonal" | "hexagon" | 
"allPoints"] | The type of plot; default "allPoints"</p></td>
    </tr>
    <tr>
      <th>saveFile</th>
      <td><p>BOOLEAN [TRUE | FALSE] | Save file to outDir; default TRUE; 
used in all options</p></td>
    </tr>
    <tr>
      <th>outDir</th>
      <td><p>CHARACTER STRING | Output directory to save all plots; default 
current directory; used in all options</p></td>
    </tr>
    <tr>
      <th>pointSize</th>
      <td><p>INTEGER | Size of plotted points; default 0.5; used for
DEGs in "hexagon" and "allPoints" and used for all points in "foldChange"
and "orthogonal"</p></td>
    </tr>
    <tr>
      <th>pointColor</th>
      <td><p>CHARACTER STRING | Color of overlaid points on scatterplot 
matrix; default "orange"; used for DEGs in "hexagon" and "allPoints" and
used for all points in "foldChange" and "orthogonal"</p></td>
    </tr>
    <tr>
      <th>xbins</th>
      <td><p>INTEGER | Number of bins partitioning the range of the plot; 
default 10; used in option "hexagon"</p></td>
    </tr>
    <tr>
      <th>threshFC</th>
      <td><p>INTEGER | Threshold of fold change; default 3; used in
option "foldChange"</p></td>
    </tr>
    <tr>
      <th>threshOrth</th>
      <td><p>INTEGER | Threshold of orthogonal distance; default 3;
used in option "orthogonal"</p></td>
    </tr>
    <tr>
      <th>threshVar</th>
      <td><p>CHARACTER STRING | Name of column in dataMetrics object
that is used to threshold significance; default "FDR"; used in all options</p></td>
    </tr>
    <tr>
      <th>threshVal</th>
      <td><p>INTEGER | Maximum value to threshold significance from 
threshVar object; default 0.05; used in all options</p></td>
    </tr>
    <tr>
      <th>geneList</th>
      <td><p>CHARACTER ARRAY | List of gene IDs to be drawn onto the 
scatterplot matrix of all data. Use this parameter if you have predetermined 
genes to be drawn. Otherwise, use dataMetrics, threshVar, and threshVal to 
create genes to be drawn onto the scatterplot matrix; default NULL; used in 
"hexagon" and "allPoints"</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>List of n elements of scatterplot matrices, where n is the number of 
treatment pair combinations in the data object. The subset of genes that are 
superimposed are determined through the dataMetrics or geneList parameter.
If the saveFile parameter has a value of TRUE, then each of these
scatterplot matrices is saved to the location specified in the outDir
parameter as a JPG file.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>There are seven options:</p><ul>
<li><p>"foldChange": Plots DEGs onto scatterplot matrix of fold changes</p></li>
<li><p>"orthogonal": Plots DEGs onto scatterplot matrix of orthogonal 
distance</p></li>
<li><p>"hexagon": Plot DEGs onto scatterplot matrix of hexagon binning</p></li>
<li><p>"allPoints": Plot DEGs onto scatterplot matrix of all data points</p></li>
</ul>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Read in data and metrics (need for all examples)</span>
<span class='fu'>data</span>(<span class='no'>soybean_cn_sub</span>)
<span class='fu'>data</span>(<span class='no'>soybean_cn_sub_metrics</span>)
<span class='fu'>data</span>(<span class='no'>soybean_ir_sub</span>)
<span class='fu'>data</span>(<span class='no'>soybean_ir_sub_metrics</span>)

<span class='co'># Create standardized version of data (need for some examples)</span>
<span class='fu'>library</span>(<span class='no'>matrixStats</span>)
<span class='fu'>library</span>(<span class='no'>ggplot2</span>)
<span class='no'>soybean_cn_sub_st</span> <span class='kw'>&lt;-</span> <span class='fu'>as.data.frame</span>(<span class='fu'>t</span>(<span class='fu'>apply</span>(<span class='fu'>as.matrix</span>(<span class='no'>soybean_cn_sub</span>[,-<span class='fl'>1</span>]),
    <span class='fl'>1</span>, <span class='no'>scale</span>)))
<span class='no'>soybean_cn_sub_st</span>$<span class='no'>ID</span> <span class='kw'>&lt;-</span> <span class='fu'>as.character</span>(<span class='no'>soybean_cn_sub</span>$<span class='no'>ID</span>)
<span class='no'>soybean_cn_sub_st</span> <span class='kw'>&lt;-</span> <span class='no'>soybean_cn_sub_st</span>[,<span class='fu'>c</span>(<span class='fu'>length</span>(<span class='no'>soybean_cn_sub_st</span>),
    <span class='fl'>1</span>:<span class='fu'>length</span>(<span class='no'>soybean_cn_sub_st</span>)-<span class='fl'>1</span>)]
<span class='fu'>colnames</span>(<span class='no'>soybean_cn_sub_st</span>) <span class='kw'>&lt;-</span> <span class='fu'>colnames</span>(<span class='no'>soybean_cn_sub</span>)
<span class='no'>nID</span> <span class='kw'>&lt;-</span> <span class='fu'>which</span>(<span class='fu'>is.nan</span>(<span class='no'>soybean_cn_sub_st</span>[,<span class='fl'>2</span>]))
<span class='no'>soybean_cn_sub_st</span>[<span class='no'>nID</span>,<span class='fl'>2</span>:<span class='fu'>length</span>(<span class='no'>soybean_cn_sub_st</span>)] <span class='kw'>&lt;-</span> <span class='fl'>0</span></div><span class='co'># NOT RUN {</span>
<span class='co'># Example 1: Plot scatterplot matrix of points. Saves three plots to outDir </span>
<span class='co'># because saveFile equals TRUE by default.</span>

<span class='fu'>plotSM</span>(<span class='no'>soybean_cn_sub</span>, <span class='no'>soybean_cn_sub_metrics</span>)
<span class='co'># }</span><div class='input'>
<span class='co'># Example 2: Plot scatterplot matrix of points. Return list of plots so user </span>
<span class='co'># can tailor them (such as add title) and does not save to outDir because </span>
<span class='co'># saveFile equals FALSE.</span>

<span class='no'>ret</span> <span class='kw'>&lt;-</span> <span class='fu'>plotSM</span>(<span class='no'>soybean_cn_sub</span>, <span class='no'>soybean_cn_sub_metrics</span>, <span class='kw'>pointColor</span> <span class='kw'>=</span> <span class='st'>"pink"</span>,
    <span class='kw'>saveFile</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='co'># Determine names of plots in returned list</span>
<span class='fu'>names</span>(<span class='no'>ret</span>)</div><div class='output co'>#&gt; [1] "S1_S2" "S1_S3" "S2_S3"</div><div class='input'><span class='no'>ret</span><span class='kw'>[[</span><span class='st'>"S1_S2"</span>]] + <span class='fu'><a href='ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span>(<span class='st'>"S1 versus S2"</span>)</div><div class='img'><img src='plotSM-1.png' alt='' width='700' height='700' /></div><div class='input'><span class='no'>ret</span><span class='kw'>[[</span><span class='st'>"S1_S3"</span>]] + <span class='fu'><a href='ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span>(<span class='st'>"S1 versus S3"</span>)</div><div class='img'><img src='plotSM-2.png' alt='' width='700' height='700' /></div><div class='input'><span class='no'>ret</span><span class='kw'>[[</span><span class='st'>"S2_S3"</span>]] + <span class='fu'><a href='ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span>(<span class='st'>"S2 versus S3"</span>)</div><div class='img'><img src='plotSM-3.png' alt='' width='700' height='700' /></div><div class='input'>
<span class='co'># Example 3: Plot standardized data as scatterplot matrix of points.</span>

<span class='no'>ret</span> <span class='kw'>&lt;-</span> <span class='fu'>plotSM</span>(<span class='no'>soybean_cn_sub_st</span>, <span class='no'>soybean_cn_sub_metrics</span>,
    <span class='kw'>pointColor</span> <span class='kw'>=</span> <span class='st'>"#00C379"</span>, <span class='kw'>saveFile</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='no'>ret</span><span class='kw'>[[</span><span class='fl'>1</span>]] + <span class='fu'><a href='ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span>(<span class='st'>"Standardized read counts"</span>) +
<span class='fu'><a href='ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span>(<span class='st'>"Standardized read counts"</span>)</div><div class='img'><img src='plotSM-4.png' alt='' width='700' height='700' /></div><div class='input'>
<span class='co'># Example 4: Plot scatterplot matrix of hexagons.</span>

<span class='no'>ret</span> <span class='kw'>&lt;-</span> <span class='fu'>plotSM</span>(<span class='no'>soybean_cn_sub</span>, <span class='no'>soybean_cn_sub_metrics</span>, <span class='kw'>option</span> <span class='kw'>=</span> <span class='st'>"hexagon"</span>,
    <span class='kw'>xbins</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>pointSize</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>saveFile</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='no'>ret</span><span class='kw'>[[</span><span class='fl'>2</span>]]</div><div class='img'><img src='plotSM-5.png' alt='' width='700' height='700' /></div><div class='input'>
<span class='co'># Example 5: Plot scatterplot matrix of orthogonal distance on the logged</span>
<span class='co'># data, first without considering the metrics dataset and then considering</span>
<span class='co'># it.</span>

<span class='no'>soybean_ir_sub</span>[,-<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fu'>log</span>(<span class='no'>soybean_ir_sub</span>[,-<span class='fl'>1</span>] + <span class='fl'>1</span>)
<span class='no'>ret</span> <span class='kw'>&lt;-</span> <span class='fu'>plotSM</span>(<span class='no'>soybean_ir_sub</span>, <span class='kw'>option</span> <span class='kw'>=</span> <span class='st'>"orthogonal"</span>, <span class='kw'>threshOrth</span> <span class='kw'>=</span> <span class='fl'>2.5</span>,
    <span class='kw'>pointSize</span> <span class='kw'>=</span> <span class='fl'>0.2</span>, <span class='kw'>saveFile</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='no'>ret</span><span class='kw'>[[</span><span class='fl'>1</span>]]</div><div class='img'><img src='plotSM-6.png' alt='' width='700' height='700' /></div><div class='input'><span class='no'>ret</span> <span class='kw'>&lt;-</span> <span class='fu'>plotSM</span>(<span class='no'>soybean_ir_sub</span>, <span class='no'>soybean_ir_sub_metrics</span>, <span class='kw'>option</span> <span class='kw'>=</span> <span class='st'>"orthogonal"</span>,
    <span class='kw'>threshOrth</span> <span class='kw'>=</span> <span class='fl'>2.5</span>, <span class='kw'>pointSize</span> <span class='kw'>=</span> <span class='fl'>0.2</span>, <span class='kw'>saveFile</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='no'>ret</span><span class='kw'>[[</span><span class='fl'>1</span>]]</div><div class='img'><img src='plotSM-7.png' alt='' width='700' height='700' /></div><div class='input'>
<span class='co'># Example 6: Plot scatterplot matrix of fold change.</span>

<span class='no'>ret</span> <span class='kw'>&lt;-</span> <span class='fu'>plotSM</span>(<span class='no'>soybean_cn_sub</span>, <span class='no'>soybean_cn_sub_metrics</span>, <span class='kw'>option</span> <span class='kw'>=</span> <span class='st'>"foldChange"</span>,
    <span class='kw'>threshFC</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>pointSize</span> <span class='kw'>=</span> <span class='fl'>0.2</span>, <span class='kw'>saveFile</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='no'>ret</span><span class='kw'>[[</span><span class='fl'>1</span>]]</div><div class='img'><img src='plotSM-8.png' alt='' width='700' height='700' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://github.com/lrutter'>Lindsay Rutter</a>, <a href='https://github.com/dicook'>Dianne Cook</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script>
  docsearch({
    
    
    apiKey: 'API_KEY',
    indexName: 'INDEX_NAME',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>


  </body>
</html>

